Foi criado o script de baclup "backup_mysql_ged.sh" configurado no crontab -e para ser executado todos os dias as 2h da manhã,
o backup é gerado no container, copiado para \\hbm\backup_mysql via mout e para /opt/ged/scripts/bacakup_banco
após isso o .sql de backup é excluído de dentro do container.
Foi definido que os backups .sql serão guardados por 5 dias.

=============================================================================
O arquivo sincronizar.sh tem como funcionalidade realizar o cadastro dos pacientes que estão internados no tasy, utilizando a tabela
ocupacao_hospitalar e entrada_unica para realizar o insert desses pacientes na tabela pessoa_fisica do banco de dados GED no MySQL.
Esse script também tem agendamento no crontab -e para ser executado todos os dias as 3h da manhã, podendo ser alterado a periodicidade
conforme necessidade;

#Sincroniza paciente GED Oracle x Mysql
0 3 * * * /opt/ged/scripts/sincronizar.sh

Os agendamentos podem ser verificados com o comando crontab -l

=============================================================================
Comando de montagem:
mount -t cifs //192.168.25.6/Backup_Mysql/ /opt/backups-mysql/ -o username=hbm,password=SENHA_SAMBA

Validação da montagem:
df -h
//192.168.25.6/Backup_Mysql/  916G  626G  291G  69% /opt/backups-mysql

Desmontagem:
umount -t cifs //192.168.25.6/Backup_MySQL

=============================================================================

Deve ser criado um usuário para o DEG no Oracle:
e liberado as seguintes tabelas:
atendimento_paciente, ocupacao_hospitalar, atendimento_paciente

create user ged identified by "SENHA";
grant create session to ged;

GRANT SELECT ON TASY.pessoa_fisica TO ged;
create synonym ged.pessoa_fisica for TASY.pessoa_fisica;

GRANT SELECT ON TASY.ocupacao_hospitalar TO ged;
create synonym ged.ocupacao_hospitalar for TASY.ocupacao_hospitalar;

GRANT SELECT ON TASY.atendimento_paciente TO ged;
create synonym ged.atendimento_paciente for TASY.atendimento_paciente;

Valida as tabelas e permissões criadas para o usuário GED:

SELECT GRANTEE, PRIVILEGE, OWNER, TABLE_NAME
FROM DBA_TAB_PRIVS
where GRANTEE = 'GED';

SELECT USERNAME
FROM DBA_USERS;

SELECT GRANTEE, PRIVILEGE
FROM DBA_SYS_PRIVS
order by 1;

=========================================================================
Cria pasta para log e permissçoes:

mkdir -p /opt/ged/logs
chown -R root: /opt/ged/logs
chmod -R 755 /opt/ged/logs

crontab -e
# Backup banco de dados MySQL
0 2 * * * /opt/ged/scripts/backup_mysql_vagas.sh
0 2 * * * /opt/ged/scripts/backup_mysql_ged.sh

Diretório samba onde os backups estão mapeados via mount
 \\hbm\backup_mysql


